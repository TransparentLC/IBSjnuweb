<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="author" content="TransparentLC">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/prism-github@1/prism-github.min.css,npm/github-markdown-css@4/github-markdown.min.css">
    <style>
        .markdown-body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 980px;
            margin: 0 auto;
            padding: 45px
        }

        @media (max-width:767px) {
            .markdown-body {
                padding: 15px
            }
        }
    </style>
    <title>JNU 番禺校区水电费查询 API by Akarin ⁄(⁄⁄•⁄ω⁄•⁄⁄)⁄</title>
</head>

<body>
    <div class="markdown-body">
        <h1 id="jnu-番禺校区水电费查询-api">JNU 番禺校区水电费查询 API</h1>
        <p>大部分人可能都不知道，番禺校区的校园网里实际上有一个<a href="http://10.136.2.5/IBSjnuweb/">“宿舍能耗查询系统”</a>，可以用来查自己宿舍的水电费数据。如果你之前有看到过某个“暨”字头的<ruby>公众号<rt>营销号</rt></ruby>做了“查询水电费”的功能，其中的数据实际上就来自那个系统。</p>
        <p>你可以直接去系统里手动查询，不过或许有人会需要水电费数据用于一些别的用途也说不定……？比如邮件提醒什么的，总之这里有个 API 可以用啦！(　-`ω-)✧</p>
        <blockquote>
            <p>在这里输入宿舍号（和充水电费时输入的一致，例如 T1 的 114 对应 <code>t10114</code>，T11 的 514 对应 <code>t110514</code>），看一看自己宿舍的水电费数据～</p>
            <p><input id="room" type="text"><button id="query">查询</button></p>
        </blockquote>
        <h1 id="使用方法">使用方法</h1>
        <p>
            <code>GET /IBSjnuweb/api/billing/{room}</code>
            <br>
            <code>GET /IBSjnuweb/api/billing/{room}?text</code>
            <br>
            <code>GET /IBSjnuweb/api/billing/{room}?html</code>
        </p>
        <p>接口默认返回 JSON 格式的数据，你也可以添加 URL 参数 <code>text</code> 或 <code>html</code>，分别可以获取纯文本（实际上是 Markdown）或 HTML 格式（仅添加了标签，并不是完整的网页）的查询结果。</p>
        <p><code>room</code> 是宿舍号，数据仅供参考。</p>
        <p>返回的 JSON 数据的示例与说明：</p>
        <pre><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"code"</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token property">"msg"</span><span class="token operator">:</span> <span class="token string">"T114514 查询成功"</span><span class="token punctuation">,</span>
  <span class="token property">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 水电费余额</span>
    <span class="token property">"balance"</span><span class="token operator">:</span> <span class="token number">19.19</span><span class="token punctuation">,</span>
    <span class="token comment">// 水电费补贴</span>
    <span class="token comment">// total     每个月发放的水电费补贴，单位为度（电能）和吨（冷热水）</span>
    <span class="token comment">// available 当前剩余的补贴，用完了（值为零）则开始扣费</span>
    <span class="token property">"allowance"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"electricity"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"total"</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token property">"available"</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"coldWater"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"total"</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token property">"available"</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"hotWater"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"total"</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token property">"available"</span><span class="token operator">:</span> <span class="token number">6.5</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 水电费读数</span>
    <span class="token comment">// price   单价，单位为度（电能）和吨（冷热水）</span>
    <span class="token comment">// start   上次查表时的水电表读数</span>
    <span class="token comment">// current 当前的水电表读数</span>
    <span class="token comment">// usage   增加的读数（当前值减去上次查表的值）</span>
    <span class="token property">"bill"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"electricity"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token number">0.6259</span><span class="token punctuation">,</span> <span class="token property">"start"</span><span class="token operator">:</span> <span class="token number">5521.1899</span><span class="token punctuation">,</span> <span class="token property">"current"</span><span class="token operator">:</span> <span class="token number">5670.3599</span><span class="token punctuation">,</span> <span class="token property">"usage"</span><span class="token operator">:</span> <span class="token number">149.17</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"coldWater"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token number">3.15</span><span class="token punctuation">,</span> <span class="token property">"start"</span><span class="token operator">:</span> <span class="token number">311.7</span><span class="token punctuation">,</span> <span class="token property">"current"</span><span class="token operator">:</span> <span class="token number">316.7</span><span class="token punctuation">,</span> <span class="token property">"usage"</span><span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"hotWater"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token property">"start"</span><span class="token operator">:</span> <span class="token number">41.2</span><span class="token punctuation">,</span> <span class="token property">"current"</span><span class="token operator">:</span> <span class="token number">42.7</span><span class="token punctuation">,</span> <span class="token property">"usage"</span><span class="token operator">:</span> <span class="token number">1.5</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
        <h1 id="注意事项">注意事项</h1>
        <ul>
            <li>这个接口可以直接查询到<strong>任何宿舍</strong>的水电费数据，但是<strong>水电费数据中并不会有任何涉及个人隐私的内容</strong>。</li>
            <li>仅限个人使用，请勿用于公众号等商业用途。</li>
        </ul>
        <p style="text-align:center">
            <small>Powered by Akarin ⁄(⁄⁄•⁄ω⁄•⁄⁄)⁄</small>
            <br>
            <small><a href="https://github.com/TransparentLC/IBSjnuweb" target="_blank">Source code on GitHub</a></small>
        </p>
        <script>(()=>{const n=n=>document.getElementById(n),o=n("room");n("query").onclick=()=>o.value&&open(`api/billing/${o.value}?text`)})()</script>
    </div>
</body>
</html>